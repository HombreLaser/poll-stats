{% import 'macros/buttons.jinja' as buttons %}

{% macro render(form) %}
    {% for question in form.questions.data %}
        {% if question.type.data == 'open' %}
            {{ render_open_question(question) }}
        {% else %}
            {{ render_selection_question(question)}}
        {% endif %}
    {% endfor %}

    <button id="new-field-button" class="btn btn-primary">
        <i class="bi bi-plus" style="font-size: 1rem"></i>
        Agregar pregunta
    </button>

{% endmacro %}

{% macro render_open_question(form) %}
    <div class="{{ field_class('open', form) }} mb-3">
        <div class="form-floating mb-3">
            {{ form.content(class_='content-field') }}
            {{ form.content.label }}
        </div>

        <div class="form-floating mb-3">
            {{ form.type(class_='form-select') }}
            {{ form.type.label }}
        </div>

        <div class="mb-3">
            {{ buttons.delete_button('Borrar pregunta') }}
        </div>
    </div>
{% endmacro %}

{% macro render_selection_question(form) %}
    <div class="{{ field_class('selection', form) }} mb-3">
        <div class="form-floating mb-3">
            {{ form.content(class_='content-field') }}
            {{ form.content.label }}
        </div>

        <div class="form-floating mb-3">
            {{ form.type(class_='form-select') }}
            {{ form.type.label }}
        </div>

        <div class="options-container ml-6">
            {% if form.options %}
                {% for option in form.options.data %}
                    {{ render_option(option) }}
                {% endfor %}
            {% endif %}
        </div>

        <div class="mb-3">
            <button id="{{ button_id }}" class="btn btn-primary add-option mr-3">
                <i class="bi bi-plus" style="font-size: 1.2rem"></i>
                Agregar opción
            </button>

            {{ buttons.delete_button('Borrar pregunta') }}
        </div>
    </div>
{% endmacro %}

{% macro render_option(form) %}
    <div class="{{ field_class('options', form) }} mb-3">
        <div class="form-floating mb-3">
                {{ form.content(class_='content-field') }}
                {{ form.content.label }}
        </div>

        <div class="form-floating mb-3">
            {{ form.score(class_='form-select') }}
            {{ form.score.label }}
        </div>

        <div class="mb-3">
            {{ buttons.delete_button('Borrar opción', button_id, render_icon=False)}}
        </div>
    </div>
{% endmacro %}